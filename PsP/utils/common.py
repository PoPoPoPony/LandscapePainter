import cv2
import numpy as np
from PIL import Image
import matplotlib.pyplot as plt


# Log images
def log_input_image(x, opts):
	if opts.label_nc == 0:
		return tensor2im(x)
	elif opts.label_nc == 1:
		return tensor2sketch(x)
	else:
		return tensor2map(x)


def tensor2im(var):
	var = var.cpu().detach().transpose(0, 2).transpose(0, 1).numpy()
	var = ((var + 1) / 2)
	var[var < 0] = 0
	var[var > 1] = 1
	var = var * 255
	return Image.fromarray(var.astype('uint8'))


def tensor2map(var):
	mask = np.argmax(var.data.cpu().numpy(), axis=0)
	colors = get_colors()
	mask_image = np.ones(shape=(mask.shape[0], mask.shape[1], 3))
	for class_idx in np.unique(mask):
		mask_image[mask == class_idx] = colors[class_idx]
	mask_image = mask_image.astype('uint8')
	return Image.fromarray(mask_image)


def tensor2sketch(var):
	im = var[0].cpu().detach().numpy()
	im = cv2.cvtColor(im, cv2.COLOR_GRAY2BGR)
	im = (im * 255).astype(np.uint8)
	return Image.fromarray(im)


# Visualization utils
def get_colors():
	# currently support up to 19 classes (for the celebs-hq-mask dataset)
	# colors = [[0, 0, 0], [204, 0, 0], [76, 153, 0], [204, 204, 0], [51, 51, 255], [204, 0, 204], [0, 255, 255],
	# 		  [255, 204, 204], [102, 51, 0], [255, 0, 0], [102, 204, 0], [255, 255, 0], [0, 0, 153], [0, 0, 204],
	# 		  [255, 51, 153], [0, 204, 204], [0, 51, 0], [255, 153, 51], [0, 204, 0]]
	# colors=[
	# 	[158, 44, 83], [149, 51, 100], [241, 131, 215], [68, 103, 42], [252, 225, 132], [171, 242, 74], [113, 59, 181], [135, 96, 27], [26, 214, 12], [57, 187, 237], [203, 248, 29], [223, 107, 245], [152, 190, 37], [17, 243, 123], [226, 203, 68], [135, 96, 121], [140, 194, 138], [145, 140, 102], [194, 5, 239], [0, 54, 177], [228, 220, 149], [200, 200, 24], [50, 12, 18], [21, 247, 28], [65, 242, 221], [177, 235, 23], [11, 175, 176], [104, 39, 109], [23, 203, 40], [173, 124, 71], [92, 189, 163], [214, 254, 49], [35, 86, 189], [133, 104, 223], [115, 207, 87], [219, 149, 3], [85, 233, 85], [53, 86, 100], [124, 77, 174], [29, 247, 20], [37, 129, 77], [141, 112, 135], [121, 189, 76], [174, 8, 62], [160, 91, 240], [181, 48, 26], [40, 231, 182], [159, 133, 249], [62, 3, 9], [104, 184, 181], [80, 125, 120], [1, 27, 157], [63, 124, 152], [206, 233, 72], [12, 230, 242], [11, 180, 110], [40, 198, 110], [178, 42, 34], [6, 198, 63], [114, 77, 31], [252, 50, 255], [43, 175, 66], [5, 30, 85], [1, 126, 188], [40, 59, 96], [80, 220, 108], [15, 220, 46], [78, 14, 36], [23, 231, 29], [142, 66, 154], [197, 138, 137], [131, 249, 73], [87, 37, 76], [16, 57, 10], [211, 166, 224], [174, 21, 225], [130, 55, 54], [238, 230, 19], [103, 19, 182], [237, 167, 216], [165, 49, 42], [96, 154, 24], [188, 80, 219], [51, 187, 226], [118, 192, 90], [237, 205, 25], [61, 222, 128], [58, 165, 73], [218, 36, 182], [64, 39, 132], [124, 159, 127], [46, 175, 178], [17, 242, 35], [15, 3, 110], [69, 51, 235], [146, 223, 249], [165, 250, 235], [25, 217, 117], [11, 162, 210], [18, 76, 22], [227, 78, 63], [4, 64, 62], [5, 239, 3], [245, 177, 140], [31, 18, 229], [63, 80, 42], [185, 103, 191], [255, 49, 224], [150, 198, 169], [221, 177, 166], [104, 72, 93], [108, 23, 191], [67, 27, 73], [21, 151, 83], [46, 87, 26], [57, 14, 40], [128, 179, 89], [66, 255, 203], [101, 140, 105]
	# ]

	colors = [[219, 243, 108], [1, 80, 214], [86, 178, 17], [98, 192, 134], [134, 251, 14], [45, 199, 84], [140, 229, 3], [57, 31, 152], [251, 191, 85], [235, 10, 54], [23, 66, 132], [122, 230, 116], [241, 218, 78], [124, 58, 124], [1, 186, 223], [108, 
234, 89], [77, 189, 169], [164, 114, 124], [244, 143, 231], [42, 112, 205], [244, 242, 150], [123, 95, 182], [70, 188, 218], [212, 79, 250], [247, 111, 147], [233, 176, 97], [28, 241, 22], [211, 119, 231], [153, 203, 162], [202, 88, 184], [197, 91, 251], [205, 111, 4], [211, 192, 133], [159, 221, 88], [226, 185, 50], [224, 150, 229], [230, 45, 138], [48, 231, 144], [201, 19, 133], [110, 107, 210], [251, 50, 17], [248, 86, 19], [193, 65, 240], [130, 218, 230], [150, 76, 192], 
[141, 177, 128], [102, 81, 81], [160, 230, 103], [135, 99, 56], [21, 171, 45], [16, 215, 74], [227, 162, 168], [39, 27, 
11], [214, 174, 241], [185, 226, 6], [22, 201, 223], [139, 19, 227], [28, 41, 131], [243, 161, 153], [210, 230, 55], [212, 215, 13], [133, 12, 48], [179, 190, 217], [193, 76, 158], [22, 36, 89], [137, 51, 195], [96, 46, 16], [219, 46, 240], [146, 120, 93], [62, 27, 127], [254, 209, 176], [231, 130, 239], [203, 5, 151], [150, 45, 113], [73, 97, 185], [242, 132, 189], [81, 65, 1], [20, 66, 127], [91, 197, 136], [23, 181, 37], [74, 251, 245], [42, 79, 40], [206, 88, 20], [50, 104, 3], [39, 247, 130], [101, 218, 142], [191, 158, 48], [152, 144, 22], [83, 149, 116], [128, 129, 110], [171, 164, 103], [3, 191, 225], [235, 46, 22], [84, 201, 116], [137, 150, 125], [20, 36, 145], [218, 174, 206], [15, 230, 34], [121, 75, 34], [116, 139, 111], [50, 100, 97], [74, 246, 223], [213, 254, 123], [196, 123, 11], [33, 123, 2], [54, 183, 57], [175, 233, 199], [126, 49, 230], [87, 90, 114], [200, 135, 210], [125, 176, 141], [202, 195, 69], [183, 164, 98], [14, 43, 
175], [250, 154, 212], [165, 184, 114], [253, 156, 176], [13, 181, 85], [63, 48, 31], [35, 186, 61], [234, 100, 57], [44, 229, 169], [98, 172, 17], [68, 51, 124], [251, 97, 140], [32, 210, 85], [166, 246, 205], [238, 175, 144], [167, 230, 57], [10, 140, 184], [116, 92, 117], [184, 158, 14], [179, 150, 104], [212, 255, 148], [246, 114, 39], [111, 196, 182], [86, 241, 84], [168, 199, 153], [238, 177, 1], [14, 149, 83], [37, 30, 72], [60, 123, 144], [84, 2, 58], [180, 248, 67], 
[187, 254, 56], [211, 206, 225], [83, 28, 73], [84, 95, 159], [179, 227, 248], [13, 190, 246], [31, 4, 185], [247, 82, 98], [33, 139, 178], [183, 124, 178], [233, 174, 172], [91, 29, 162], [194, 99, 145], [46, 107, 120], [215, 71, 146], [95, 157, 29], [132, 66, 103], [18, 139, 200], [188, 193, 29], [182, 220, 100], [132, 47, 68], [164, 27, 69], [226, 65, 0], [183, 29, 49], [181, 136, 30], [126, 153, 183], [102, 95, 53], [110, 14, 25], [139, 174, 54], [61, 172, 58], [243, 66, 
239], [108, 0, 150], [247, 2, 16], [28, 150, 20], [89, 43, 20], [61, 245, 186], [184, 239, 246], [66, 219, 201], [183, 202, 141], [48, 157, 58], [212, 135, 104], [67, 31, 50], [7, 34, 58], [9, 53, 61], [48, 62, 255], [156, 72, 211], [2, 40, 64], [195, 240, 109], [57, 209, 128], [35, 93, 50], [108, 15, 91], [13, 149, 143], [22, 102, 105], [178, 196, 94], [185, 134, 247], [150, 219, 161], [182, 185, 233], [188, 17, 119], [174, 20, 119], [5, 26, 100], [157, 122, 26], [194, 226, 
147], [3, 129, 32], [148, 123, 194], [27, 234, 175], [107, 200, 244], [54, 65, 44], [140, 54, 123], [175, 51, 236], [44, 140, 126], [57, 239, 23], [89, 22, 45], [9, 132, 25], [170, 228, 31], [200, 237, 126], [47, 89, 134], [250, 112, 121], 
[21, 98, 214], [246, 45, 172], [165, 196, 143], [198, 175, 116], [142, 172, 11], [21, 74, 0], [67, 254, 253], [77, 169, 
246], [16, 200, 153], [12, 80, 129], [198, 187, 12], [247, 6, 201], [57, 126, 194], [122, 170, 93], [187, 19, 89], [86, 
14, 45], [141, 33, 2], [182, 93, 219], [29, 224, 171], [29, 176, 100], [74, 185, 135], [103, 141, 172], [63, 205, 241], 
[17, 236, 86], [190, 145, 81], [218, 193, 84], [71, 57, 218], [221, 12, 222], [85, 69, 212], [12, 150, 134], [71, 157, 50], [151, 137, 43], [167, 172, 59], [240, 160, 227], [5, 196, 110], [200, 202, 71], [10, 4, 123], [79, 31, 238], [219, 127, 59], [212, 26, 34], [127, 52, 130], [250, 162, 239], [178, 151, 36], [27, 231, 108], [60, 12, 15], [236, 23, 93], [8, 20, 172], [85, 242, 73], [47, 231, 39], [77, 157, 80], [151, 143, 127], [127, 224, 96], [174, 174, 238], [194, 38, 174], [71, 29, 12], [48, 111, 11], [34, 6, 181], [25, 108, 17], [215, 13, 98], [37, 252, 206], [138, 6, 243], [151, 52, 134], [244, 38, 10], [15, 12, 217], [156, 13, 253], [56, 15, 209], [145, 158, 93], [18, 61, 124], [131, 100, 84], [223, 20, 215], [250, 48, 174], [68, 248, 97], [166, 6, 111], [3, 238, 244], [170, 50, 232], [1, 164, 247], [19, 76, 99], [62, 19, 54], [237, 200, 247], [218, 119, 126], [101, 242, 184], [43, 233, 35], [208, 133, 43], [220, 181, 63], [51, 16, 29], [95, 250, 141], [197, 34, 115], [151, 167, 145], [197, 179, 216], [3, 205, 239], [150, 23, 125], [239, 93, 224], [49, 127, 159], [88, 68, 2], [255, 186, 189], [168, 80, 36], [173, 124, 5], [150, 71, 76], [188, 51, 53], [35, 203, 2], [233, 245, 4], [108, 58, 142], [70, 201, 116], [239, 95, 105], [212, 139, 195], [217, 125, 180], [202, 125, 123], [227, 7, 195], [69, 96, 182], [25, 48, 151], [30, 20, 154], [125, 231, 52], [5, 254, 158], [138, 61, 91], [68, 62, 126], [215, 53, 132], [252, 50, 183], [228, 101, 14], [232, 225, 178], [229, 45, 36], [159, 122, 19], [64, 136, 139], [176, 85, 23], [154, 
131, 50], [109, 12, 174], [246, 84, 30], [211, 140, 123], [158, 96, 70], [84, 111, 88], [64, 223, 249], [250, 145, 232], [146, 46, 201], [235, 9, 99], [193, 23, 23], [147, 166, 194], [162, 149, 41], [198, 106, 143], [189, 155, 241], [90, 204, 81], [148, 45, 20], [123, 217, 57], [18, 221, 169], [171, 251, 18], [110, 175, 159], [91, 46, 28], [47, 69, 196], [23, 151, 58], [8, 208, 158], [102, 137, 54], [5, 38, 88], [153, 137, 152], [230, 80, 108], [132, 146, 52], [53, 50, 90], [70, 128, 207], [19, 170, 44], [220, 82, 162], [246, 52, 35], [179, 177, 218], [77, 33, 173], [68, 91, 179], [55, 11, 182], [140, 79, 132], [134, 128, 255], [50, 89, 103], [237, 65, 140], [73, 208, 65], [70, 254, 130], [232, 122, 242], [68, 
250, 39], [182, 141, 251], [216, 12, 61], [139, 79, 213], [151, 160, 210], [15, 250, 245], [186, 100, 103], [150, 196, 224], [51, 157, 16], [72, 119, 161], [154, 160, 27], [93, 222, 77], [99, 233, 227], [211, 70, 82], [147, 37, 182], [251, 
17, 100], [16, 248, 133], [86, 122, 56], [36, 122, 184], [51, 236, 195], [85, 222, 155], [24, 192, 182], [43, 118, 111], [40, 47, 227], [228, 134, 25], [230, 5, 132], [78, 251, 36], [17, 78, 86], [220, 64, 179], [167, 135, 205], [76, 205, 229], [66, 216, 98], [34, 224, 144], [8, 153, 67], [49, 141, 92], [10, 54, 79], [165, 68, 201], [217, 178, 200], [243, 46, 131], [42, 128, 223], [225, 165, 222], [237, 103, 12], [31, 193, 130], [133, 112, 70], [30, 254, 124], [39, 153, 16], 
[202, 86, 207], [203, 212, 16], [24, 44, 23], [62, 116, 36], [220, 212, 180], [43, 227, 3], [88, 31, 124], [101, 155, 226], [64, 128, 25], [207, 57, 49], [165, 2, 209], [215, 249, 164], [3, 52, 100], [108, 6, 17], [88, 192, 246], [193, 187, 35], [126, 237, 86], [119, 134, 109], [66, 225, 207], [175, 155, 122], [238, 66, 15], [64, 4, 99], [84, 176, 224], [237, 252, 224], [57, 159, 110], [255, 119, 4], [52, 128, 194], [150, 51, 89], [162, 169, 181], [49, 59, 125], [168, 87, 91], [80, 132, 90], [30, 84, 15], [227, 110, 136], [150, 70, 83], [165, 208, 5], [43, 165, 194], [0, 162, 162], [132, 84, 66], [204, 24, 188], [80, 146, 207], [222, 66, 75], [86, 105, 15], [7, 181, 246], [21, 181, 14], [148, 1, 38], [245, 239, 13], [169, 250, 192], [196, 210, 58], [220, 13, 162], [101, 62, 20], [77, 7, 33], [149, 219, 11], [153, 130, 64], [114, 46, 109], [116, 150, 255], [239, 195, 73], [19, 110, 17], [106, 13, 80], [245, 4, 30], [195, 26, 243], [170, 154, 197], [74, 62, 204], [176, 37, 237], [147, 5, 22], [141, 56, 232], [164, 202, 155], [9, 239, 10], [243, 204, 22], [160, 137, 
88], [26, 142, 209], [213, 180, 158], [74, 249, 67], [103, 232, 60], [209, 222, 200], [79, 193, 229], [140, 195, 21], [9, 94, 37], [97, 49, 77], [90, 226, 102], [8, 230, 132], [69, 183, 49], [195, 93, 210], [117, 249, 121], [125, 40, 160], 
[71, 119, 25], [201, 21, 150], [3, 11, 126], [138, 204, 144], [9, 149, 240], [114, 248, 123], [92, 166, 11], [254, 71, 198], [153, 226, 120], [56, 241, 5], [42, 73, 84], [29, 250, 5], [100, 24, 78], [66, 209, 235], [193, 241, 49], [152, 182, 117], [27, 183, 210], [254, 148, 243], [154, 171, 5], [115, 42, 171], [147, 175, 103], [210, 166, 141], [233, 50, 163], [220, 50, 116], [3, 224, 51], [209, 194, 194], [223, 186, 114], [165, 35, 162], [23, 138, 232], [71, 9, 225], [66, 42, 98], [179, 211, 86], [218, 135, 139], [231, 0, 203], [24, 247, 92], [131, 168, 37], [115, 160, 118], [165, 239, 175], [251, 185, 113], [168, 20, 194], [96, 149, 123], [147, 66, 233], [142, 102, 140], [109, 166, 227], [96, 135, 184], [116, 
247, 106], [237, 200, 131], [67, 141, 106], [53, 22, 59], [119, 54, 1], [23, 87, 50], [120, 116, 185], [245, 98, 165], [48, 102, 50], [2, 12, 79], [197, 1, 94], [1, 50, 1], [231, 200, 133], [138, 231, 245], [157, 163, 103], [132, 63, 89], [136, 19, 58], [244, 3, 36], [42, 241, 84], [168, 209, 122], [65, 97, 70], [239, 86, 43], [218, 64, 204], [221, 95, 192], [71, 124, 1], [73, 126, 100], [95, 105, 35], [82, 20, 147], [31, 49, 11], [189, 4, 89], [39, 89, 248], [13, 214, 91], [169, 220, 133], [133, 226, 51], [220, 203, 96], [237, 9, 205], [230, 247, 126], [228, 126, 93], [44, 64, 93], [16, 216, 
145], [26, 231, 224], [76, 117, 95], [171, 112, 96], [27, 209, 189], [248, 222, 43], [135, 7, 2], [109, 254, 32], [199, 
82, 90], [196, 176, 52], [164, 155, 134], [145, 7, 69], [87, 42, 132], [224, 221, 235], [108, 21, 52], [133, 95, 231], [75, 43, 216], [193, 41, 113], [8, 2, 201], [206, 17, 138], [44, 67, 84], [152, 118, 56], [224, 172, 59], [198, 80, 231], [6, 79, 61], [115, 134, 38], [43, 252, 176], [67, 115, 47], [196, 67, 183], [166, 37, 81], [30, 36, 229], [108, 56, 212], [2, 0, 146], [250, 169, 209], [172, 160, 27], [207, 91, 149], [65, 26, 173], [4, 236, 128], [33, 214, 85], [252, 223, 234], [132, 205, 157], [224, 162, 202], [67, 18, 241], [253, 4, 142], [199, 26, 162], [56, 129, 47], [229, 55, 239], [241, 237, 120], [224, 216, 123], [2, 60, 50], [56, 118, 183], [173, 91, 148], [254, 231, 229], [224, 60, 64], [152, 168, 
11], [242, 121, 48], [236, 44, 91], [227, 215, 25], [125, 196, 229], [127, 97, 59], [100, 113, 226], [55, 195, 23], [80, 33, 245], [167, 116, 1], [247, 169, 2], [197, 155, 188], [234, 47, 93], [196, 255, 186], [104, 228, 65], [177, 40, 91], [184, 193, 135], [158, 207, 55], [98, 249, 253], [113, 220, 38], [2, 171, 243], [228, 207, 77], [177, 73, 33], [13, 252, 147], [148, 126, 62], [64, 173, 101], [207, 66, 44], [15, 149, 222], [247, 4, 217], [68, 88, 74], [128, 16, 111], [187, 34, 194], [238, 86, 46], [43, 141, 136], [221, 103, 214], [100, 174, 51], [246, 179, 231], [240, 160, 239], [115, 41, 
65], [185, 64, 62], [120, 4, 152], [191, 28, 175], [85, 211, 88], [29, 220, 133], [217, 94, 33], [176, 23, 79], [176, 253, 44], [139, 123, 252], [201, 157, 226], [41, 243, 243], [244, 201, 220], [208, 15, 116], [104, 35, 62], [20, 70, 159], [58, 30, 249], [208, 90, 108], [221, 107, 164], [206, 202, 5], [114, 135, 46], [19, 210, 225], [111, 236, 230], [90, 75, 116], [195, 114, 141], [223, 246, 162], [113, 211, 174], [106, 212, 217], [229, 48, 45], [152, 206, 163], [202, 156, 108], [213, 211, 250], [76, 253, 100], [101, 114, 23], [97, 225, 170], [54, 38, 62], [54, 71, 155], [237, 9, 222], [66, 195, 61], [36, 216, 78], [236, 174, 171], [154, 83, 154], [16, 64, 127], [247, 172, 230], [68, 2, 194], [48, 118, 131], [239, 41, 184], [220, 84, 125], [207, 27, 182], [219, 60, 27], [87, 34, 2], [215, 46, 185], [83, 71, 164], [88, 119, 70], [35, 45, 46], [215, 17, 247], [58, 244, 85], [187, 36, 230], [204, 121, 190], [30, 211, 222], [194, 115, 245], [213, 41, 51], [129, 74, 45], [88, 228, 29], [176, 18, 186], [185, 55, 152], [100, 24, 25], [57, 177, 138], [54, 173, 50], [169, 89, 8], [249, 57, 234], [242, 130, 207], [19, 104, 90], [146, 56, 138], [31, 25, 245], [53, 71, 10], [240, 80, 179], [58, 164, 215], [202, 51, 172], [129, 128, 85], [255, 251, 205], [36, 188, 210], [153, 148, 20], [92, 176, 103], [130, 34, 30], [245, 111, 170], [238, 228, 57], [174, 73, 197], [148, 56, 215], [237, 197, 28], [175, 93, 80], [97, 4, 114], [148, 116, 160], [153, 253, 114], [110, 137, 248], [175, 148, 30], [15, 65, 87], [168, 225, 152], [118, 13, 205], [73, 248, 
66], [184, 158, 223], [212, 222, 110], [127, 134, 135], [175, 85, 161], [91, 246, 182], [85, 205, 204], [38, 199, 8], [144, 83, 26], [75, 162, 141], [31, 247, 60], [187, 192, 199], [16, 160, 247], [23, 152, 129], [180, 184, 1], [100, 114, 93], [72, 106, 39], [129, 67, 201], [137, 76, 85], [246, 193, 116], [170, 234, 147], [174, 69, 106], [165, 124, 254], [211, 145, 209], [34, 7, 89], [113, 227, 140], [249, 254, 117], [54, 31, 148], [206, 13, 13], [141, 118, 149], [60, 85, 196], [191, 228, 202], [183, 70, 117], [229, 121, 155], [243, 99, 143], [113, 5, 27], [47, 125, 93], [85, 138, 248], [171, 
156, 44], [163, 104, 57], [54, 92, 132], [241, 92, 204], [43, 201, 186], [217, 141, 94], [113, 243, 30], [227, 247, 207], [200, 11, 224], [240, 16, 56], [96, 7, 212], [64, 71, 144], [171, 204, 202], [57, 56, 63], [155, 128, 193], [105, 22, 
28], [165, 148, 227], [46, 157, 4], [183, 236, 84], [215, 218, 235], [175, 151, 211], [90, 204, 209], [30, 181, 42], [136, 206, 11], [191, 70, 69], [2, 158, 107], [122, 215, 64], [232, 39, 44], [162, 150, 17], [87, 84, 183], [32, 52, 41], [178, 208, 79], [94, 104, 78], [198, 58, 37], [13, 119, 0], [130, 34, 79], [167, 105, 210], [250, 97, 205], [233, 91, 13], [15, 84, 56], [125, 7, 189], [74, 81, 62], [154, 212, 42], [216, 180, 237], [118, 55, 145], [167, 252, 14], [72, 123, 
7], [117, 47, 33], [32, 218, 13], [102, 39, 116], [12, 106, 205], [154, 253, 100], [108, 253, 103], [235, 88, 65], [248, 110, 174], [200, 40, 163], [31, 134, 93], [182, 224, 112], [64, 2, 45], [111, 77, 216], [231, 75, 192], [219, 181, 248], [61, 242, 176], [33, 49, 4], [152, 42, 244], [242, 99, 141], [74, 62, 109], [164, 143, 92], [117, 82, 209], [95, 200, 
17], [170, 123, 118], [85, 34, 133], [28, 170, 144], [70, 243, 192], [173, 207, 228], [169, 88, 73], [206, 55, 41], [89, 206, 212], [82, 70, 127], [88, 92, 227], [232, 90, 60], [143, 11, 88], [141, 211, 127], [182, 229, 210], [65, 181, 52], [53, 61, 57], [172, 119, 33], [183, 161, 12], [137, 163, 245], [66, 151, 76], [195, 92, 60], [107, 95, 92], [141, 14, 14], [189, 59, 191], [51, 16, 248], [243, 3, 179], [57, 247, 210], [208, 83, 114], [6, 2, 200], [40, 18, 218], [27, 26, 95], [154, 164, 27], [101, 68, 124], [66, 187, 199], [122, 79, 219], [187, 164, 96], [143, 158, 129], [91, 211, 224], [223, 93, 208], [242, 2, 22], [127, 199, 154], [68, 134, 166], [89, 193, 173], [151, 217, 113], [201, 92, 105], [202, 162, 
132], [6, 172, 16], [52, 238, 15], [175, 189, 242], [38, 83, 192], [96, 188, 247], [144, 151, 168], [197, 208, 113], [115, 214, 75], [214, 36, 46], [223, 102, 173], [74, 194, 233], [227, 141, 229], [168, 234, 200], [16, 97, 132], [231, 11, 
152], [54, 206, 54], [142, 96, 13], [241, 53, 205], [7, 175, 5], [155, 114, 25], [188, 113, 14], [115, 128, 106], [228, 
254, 85], [88, 50, 32], [103, 50, 121], [217, 3, 183], [102, 32, 195], [127, 62, 209], [111, 246, 97], [56, 112, 156], [177, 103, 89], [183, 69, 87], [175, 251, 38], [207, 130, 52], [123, 140, 228], [57, 168, 46], [138, 91, 132], [92, 33, 122], [86, 98, 63], [165, 7, 154], [65, 7, 18], [30, 121, 77], [239, 75, 137], [236, 202, 18], [159, 170, 209], [129, 195, 36], [109, 236, 83], [228, 21, 174], [151, 255, 69], [240, 197, 200], [30, 43, 13], [97, 135, 219], [109, 213, 87], [44, 14, 39], [138, 202, 186], [175, 231, 221], [99, 254, 46], [241, 91, 241], [99, 17, 6], [154, 128, 31], [90, 33, 51], 
[128, 13, 245], [167, 81, 37], [140, 200, 190], [170, 233, 139], [148, 11, 176], [82, 19, 199], [206, 162, 156], [158, 115, 152], [77, 86, 55], [122, 10, 232], [189, 187, 28], [193, 194, 255], [182, 57, 137], [104, 105, 228], [63, 64, 87], 
[177, 145, 227], [30, 187, 45], [77, 182, 69], [185, 59, 193], [68, 173, 234], [176, 28, 175], [122, 15, 97], [151, 198, 245], [173, 44, 250], [181, 95, 37], [174, 153, 215], [246, 89, 164], [221, 94, 93], [102, 158, 202], [36, 235, 109], [52, 83, 46], [134, 253, 36], [100, 139, 205], [220, 237, 213], [50, 160, 136], [50, 104, 155], [133, 137, 207], [84, 144, 171], [94, 149, 44], [15, 134, 47], [178, 168, 192], [251, 144, 245], [38, 13, 9], [245, 68, 56], [157, 127, 86], [180, 23, 153], [249, 48, 164], [165, 215, 251], [205, 205, 133], [124, 180, 14], [99, 5, 199], [100, 177, 78], [145, 82, 75], [50, 247, 47], [194, 105, 49], [180, 201, 140], [146, 114, 75], [249, 229, 29], [216, 102, 49], [94, 78, 71], [144, 173, 128], [168, 31, 163], [111, 90, 71], [110, 109, 76], [198, 0, 140], [108, 112, 207], [91, 195, 109], [192, 59, 207], [227, 41, 16], [78, 37, 15], [56, 68, 248], [78, 58, 130], [150, 118, 146], [101, 203, 139], [1, 41, 108], [199, 69, 252], [211, 13, 248], [136, 35, 11], [165, 54, 32], [105, 112, 145], [111, 153, 134], [137, 252, 32], [211, 132, 150], [207, 217, 111], [213, 68, 56], [252, 191, 26], [4, 131, 116], [173, 143, 20], [250, 143, 114], [242, 152, 4], [72, 133, 136], [62, 144, 240], [17, 92, 27], [156, 34, 236], [160, 46, 126], [135, 215, 213], [188, 58, 18], [233, 166, 20], [180, 
125, 22], [79, 52, 128], [171, 5, 253], [133, 71, 80], [33, 41, 127], [60, 234, 39], [193, 109, 13], [203, 75, 15], [90, 45, 48], [66, 61, 115], [42, 180, 167], [194, 126, 188], [103, 62, 244], [180, 1, 175], [220, 236, 195], [154, 198, 254], [71, 30, 94], [179, 83, 188], [26, 122, 110], [94, 241, 69], [152, 155, 38], [161, 238, 92], [74, 53, 109], [95, 81, 
139], [75, 90, 182], [1, 27, 222], [182, 133, 117], [155, 227, 62], [55, 184, 172], [186, 47, 193], [247, 232, 174], [80, 11, 91], [168, 69, 22], [25, 120, 165], [29, 55, 169], [49, 35, 158], [43, 239, 139], [58, 204, 239], [185, 190, 161], [247, 89, 0], [80, 164, 177], [36, 255, 249], [65, 86, 58], [254, 243, 29], [149, 117, 192], [31, 68, 144], [32, 5, 183], [43, 132, 230], [166, 35, 158], [33, 154, 108], [120, 79, 83], [57, 65, 26], [150, 38, 22], [108, 116, 43], [152, 166, 248], [218, 247, 203], [17, 172, 186], [114, 151, 170], [208, 59, 175], [64, 57, 233], [225, 14, 249], [180, 19, 140], [121, 189, 177], [215, 69, 33], [60, 136, 253], [80, 65, 191], [212, 242, 210], [246, 64, 27], [176, 80, 231], [228, 219, 106], [220, 252, 90], [44, 123, 180], [33, 135, 17], [2, 90, 41], [243, 215, 24], [205, 51, 8], [206, 46, 141], [228, 36, 236], [239, 144, 30], [153, 201, 49], [253, 124, 46], [237, 246, 146], [111, 39, 83], [250, 80, 48], [43, 10, 239], [215, 152, 140], [131, 117, 135], [247, 150, 227], [100, 58, 63], [232, 248, 244], [54, 205, 43], [47, 215, 236], [208, 97, 124], [208, 53, 15], [146, 64, 41], [135, 35, 132], [120, 50, 217], [100, 46, 74], [147, 198, 178], [21, 237, 100], [81, 87, 123], [63, 190, 133], [222, 15, 79], [56, 42, 199], [23, 74, 153], [172, 127, 76], [206, 21, 171], [119, 179, 
2], [16, 35, 98], [136, 23, 80], [130, 53, 83], [99, 250, 37], [123, 88, 98], [185, 167, 80], [225, 34, 152], [138, 204, 230], [93, 55, 127], [37, 213, 67], [232, 106, 58], [14, 210, 65], [189, 162, 97], [235, 168, 181], [153, 50, 215], [190, 200, 80], [1, 192, 89], [180, 242, 67], [191, 234, 130], [22, 86, 241], [221, 139, 229], [151, 133, 108], [228, 176, 
251], [70, 172, 48], [152, 188, 201], [214, 86, 5], [230, 71, 50], [38, 249, 15], [223, 151, 60], [94, 75, 24], [156, 186, 64], [196, 80, 141], [8, 219, 152], [91, 99, 52], [42, 246, 213], [178, 127, 107], [224, 77, 84], [147, 177, 144], [6, 125, 85], [246, 10, 237], [3, 195, 115], [18, 42, 103], [224, 233, 3], [5, 17, 104], [109, 233, 244], [188, 85, 164], 
[145, 31, 122], [177, 49, 63], [228, 176, 13], [144, 215, 230], [198, 183, 43], [11, 50, 126], [224, 202, 4], [35, 79, 172], [131, 239, 130], [62, 192, 44], [36, 78, 60], [107, 172, 198], [1, 246, 16], [41, 76, 59], [128, 174, 51], [103, 39, 49], [166, 169, 20], [116, 90, 49], [237, 8, 203], [129, 123, 114], [242, 223, 123], [245, 2, 69], [251, 90, 0], [219, 123, 216], [30, 169, 16], [91, 92, 166], [68, 28, 15], [196, 181, 135], [15, 128, 128], [27, 181, 85], [211, 28, 165], 
[57, 182, 52], [236, 233, 24], [60, 204, 192], [159, 166, 200], [156, 140, 134], [249, 98, 166], [24, 63, 62], [35, 142, 111], [94, 183, 180], [106, 75, 10], [229, 175, 166], [11, 59, 59], [173, 53, 56], [90, 87, 217], [127, 164, 74], [241, 231, 41], [193, 19, 118], [133, 28, 29], [35, 45, 166], [123, 15, 252], [129, 73, 137], [242, 112, 234], [114, 188, 172], [246, 204, 91], [182, 141, 236], [15, 31, 3], [218, 101, 194], [162, 3, 201], [204, 151, 99], [170, 198, 38], [215, 146, 50], [119, 106, 221], [177, 93, 64], [93, 96, 1], [136, 216, 113], [13, 60, 15], [143, 67, 232], [255, 8, 27], [88, 
37, 215], [76, 226, 191], [97, 172, 172], [99, 23, 33], [142, 95, 103], [163, 123, 212], [123, 160, 229], [83, 183, 151], [162, 117, 121], [38, 57, 79], [131, 248, 2], [12, 137, 136], [28, 122, 3], [238, 60, 50], [29, 224, 61], [96, 146, 140], [93, 79, 82], [205, 20, 103], [97, 16, 180], [54, 238, 183], [135, 78, 153], [90, 153, 213], [121, 131, 228], [180, 
18, 44], [30, 203, 112], [37, 51, 191], [133, 98, 136], [150, 94, 211], [230, 178, 55], [80, 181, 217], [176, 107, 32], 
[183, 125, 169], [156, 9, 112], [178, 174, 72], [191, 240, 169], [142, 160, 183], [153, 217, 15], [197, 110, 4], [243, 180, 99], [108, 148, 210], [86, 148, 67], [196, 148, 16], [71, 66, 81], [54, 252, 90], [181, 85, 17], [161, 62, 58], [118, 155, 128], [72, 35, 152], [48, 6, 99], [76, 72, 98], [114, 241, 87], [95, 161, 200], [230, 59, 126], [27, 6, 40], [165, 186, 245], [27, 133, 31], [126, 89, 5], [35, 105, 93], [136, 162, 183], [185, 191, 145], [72, 154, 118], [148, 28, 129], [186, 182, 42], [223, 95, 218], [160, 15, 2], [239, 91, 139], [171, 54, 216]]


	return colors


def vis_faces(log_hooks):
	display_count = len(log_hooks)
	fig = plt.figure(figsize=(8, 4 * display_count))
	gs = fig.add_gridspec(display_count, 3)
	for i in range(display_count):
		hooks_dict = log_hooks[i]
		fig.add_subplot(gs[i, 0])
		if 'diff_input' in hooks_dict:
			vis_faces_with_id(hooks_dict, fig, gs, i)
		else:
			vis_faces_no_id(hooks_dict, fig, gs, i)
	plt.tight_layout()
	return fig


def vis_faces_with_id(hooks_dict, fig, gs, i):
	plt.imshow(hooks_dict['input_face'])
	plt.title('Input\nOut Sim={:.2f}'.format(float(hooks_dict['diff_input'])))
	fig.add_subplot(gs[i, 1])
	plt.imshow(hooks_dict['target_face'])
	plt.title('Target\nIn={:.2f}, Out={:.2f}'.format(float(hooks_dict['diff_views']),
	                                                 float(hooks_dict['diff_target'])))
	fig.add_subplot(gs[i, 2])
	plt.imshow(hooks_dict['output_face'])
	plt.title('Output\n Target Sim={:.2f}'.format(float(hooks_dict['diff_target'])))


def vis_faces_no_id(hooks_dict, fig, gs, i):
	plt.imshow(hooks_dict['input_face'], cmap="gray")
	plt.title('Input')
	fig.add_subplot(gs[i, 1])
	plt.imshow(hooks_dict['target_face'])
	plt.title('Target')
	fig.add_subplot(gs[i, 2])
	plt.imshow(hooks_dict['output_face'])
	plt.title('Output')
